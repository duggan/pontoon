sudo: false

language: python

env:
  global:
  - MOCK=1
  - PYPI_SERVER=testpypi
  - secure: "SZU/BEa62l7jmI2GkXxRoT8e7i4MspkEnxfwYEmpOq2NK5kulxpy5UdvxsWu0xO/qeJHPdrFiSZfhtta8bcQFj1qfW7Dy9pCqzwMVNkGwhSoKCW6TzIlubTuy3CsDL0LQHmE1PiTryP6EuYUoMqz9vTcP+WNXjjEdLYnTr0rbNo="
  - secure: "ESuLr046PkHWOq41LQYOh4BHfjcPhOzJAAchc7aT6hmjczpsYZ9dRCO2fqs8oMIrqrczDOv9XP0NI6wUdBNvXs+pbYfQiVjkmlLi/BMddYEBAB4ay3H8v0o3SZK2D6xMeB7mf6PTao+h2pR/Gg3HBWd4/cymhA48CCgOFbJEbnU="
  matrix:
  - TOXENV=py26,lib,cli,coverage
  - TOXENV=py27,lib,cli,coverage,coveralls
  - TOXENV=py33,lib,cli,coverage
  - TOXENV=py34,lib,cli,coverage
  - TOXENV=pypy,lib,cli,coverage
  - TOXENV=pypy3,lib,cli,coverage
  - TOXENV=py26,install
  - TOXENV=py27,install
  - TOXENV=py33,install
  - TOXENV=py34,install
  - TOXENV=pypy,install
  - TOXENV=pypy3,install

install:
- pip install tox

before_script:
- git clone https://github.com/sstephenson/bats.git /tmp/bats
- mkdir -p /tmp/local
- bash /tmp/bats/install.sh /tmp/local
- export PATH=$PATH:/tmp/local/bin

script:
- tox

notifications:
  email:
    on_success: never

after_success:
  - ./release.sh
